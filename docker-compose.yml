version: '3.8'

services:
  autom8-website:
    image: ghcr.io/autom8india/autom8:latest
    container_name: autom8-website
    restart: unless-stopped
    networks:
      - infrastructure
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.autom8.rule=Host(`auto-m8.pro`) || Host(`www.auto-m8.pro`)"
      - "traefik.http.routers.autom8.tls.certresolver=cloudflare"
      - "traefik.http.routers.autom8.entrypoints=websecure"
      - "traefik.http.services.autom8.loadbalancer.server.port=3000"
    deploy:
      resources:
        limits:
          memory: 256M  # Next.js needs more than static nginx
          cpus: '0.25'

networks:
  infrastructure:
    external: true
